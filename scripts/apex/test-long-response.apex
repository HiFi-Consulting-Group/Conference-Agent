// Test the AI agent response parser with a longer, realistic response
System.debug('Testing AI agent response parser with longer, realistic response...');

// Test the AI agent response parser with a longer sample response that matches the real AI agent
String sampleResponse = 'Result:[action=Action:[apiVersion=null, invocations=({action=generateResponse, timestamp=8/10/2025, 4:22 PM, userMessage=Please build a proposed conference schedule for event ID: a01gK000003EcrhQAC. Context: {"selectedOption":"new","timestamp":"2025-08-10T23:22:00.465Z"}. Use the available sessions and locations to create an optimized schedule. Return the schedule in parsable JSON without any HTML tags or formatting. Do not escape quotes or add new line characters.}), invokeFromLightningComponent=false, name=Scheduling_Agent_1, namespace=null, type=generateAiAgentResponse], errors=(), invocationParameters=(already output), outputParameters={agentResponse={"type":"Text","value":"{\n\"proposedSchedule\": [\n{\n\"sessionName\": \"Too Small to Succeed: On the Salesforce Size Myth\",\n\"speakers\": [\"Aisha Al-Farsi\", \"Zola Adeyemi\"],\n\"location\": \"Ballroom\",\n\"startTime\": \"2025-08-11T09:00:00Z\",\n\"endTime\": \"2025-08-11T09:45:00Z\"\n},\n{\n\"sessionName\": \"Everyone Can Git It!\",\n\"speakers\": [\"Avi Green\", \"Mason Brown\"],\n\"location\": \"Ballroom\",\n\"startTime\": \"2025-08-11T09:55:00Z\",\n\"endTime\": \"2025-08-11T11:25:00Z\"\n},\n{\n\"sessionName\": \"Everybody is Awesome\",\n\"speakers\": [\"Yuki Ito\", \"Ana Gonzalez\"],\n\"location\": \"Ballroom\",\n\"startTime\": \"2025-08-11T11:35:00Z\",\n\"endTime\": \"2025-08-11T12:20:00Z\"\n},\n{\n\"sessionName\": \"Crafting Your Fundraising Gameplan: Segmentation and Engagement Strategies\",\n\"speakers\": [\"Mei Huang\", \"Mei Zhao\"],\n\"location\": \"Ballroom\",\n\"startTime\": \"2025-08-11T13:00:00Z\",\n\"endTime\": \"2025-08-11T13:45:00Z\"\n},\n{\n\"sessionName\": \"AI Now with Einstein Copilot and Prompt Builder\",\n\"speakers\": [\"James Davis\", \"Jing Chen\"],\n\"location\": \"Ballroom\",\n\"startTime\": \"2025-08-11T13:55:00Z\",\n\"endTime\": \"2025-08-11T15:25:00Z\"\n},\n{\n\"sessionName\": \"Simplifying Complexity & Creating End User Love Through Business Process Mapping\",\n\"speakers\": [\"Diego Perez\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T09:00:00Z\",\n\"endTime\": \"2025-08-11T09:45:00Z\"\n},\n{\n\"sessionName\": \"Notification Liberation: Using Slack or MS Teams in Flow for Communications\",\n\"speakers\": [\"Ryo Watanabe\", \"Layla Al-Mansoor\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T09:55:00Z\",\n\"endTime\": \"2025-08-11T10:40:00Z\"\n},\n{\n\"sessionName\": \"Fa√ßade Pattern with Apex and Flow Actions\",\n\"speakers\": [\"Wei Li\", \"Arjun Ahmed\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T10:50:00Z\",\n\"endTime\": \"2025-08-11T11:35:00Z\"\n},\n{\n\"sessionName\": \"Awesome (Autistic) Admin!\",\n\"speakers\": [\"Valeria Rodriguez\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T11:45:00Z\",\n\"endTime\": \"2025-08-11T12:30:00Z\"\n},\n{\n\"sessionName\": \"Enhanced Omni-Channel - New Features and Functionality\",\n\"speakers\": [\"Emi Takahashi\", \"Isabella Garcia\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T13:00:00Z\",\n\"endTime\": \"2025-08-11T13:45:00Z\"\n},\n{\n\"sessionName\": \"Salesforce isnt the problem...but your UX might be\",\n\"speakers\": [\"Takashi Tanaka\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T13:55:00Z\",\n\"endTime\": \"2025-08-11T14:40:00Z\"\n},\n{\n\"sessionName\": \"Architecting Data-First\",\n\"speakers\": [\"Yuki Tanaka\"],\n\"location\": \"Breakout Room A\",\n\"startTime\": \"2025-08-11T14:50:00Z\",\n\"endTime\": \"2025-08-11T15:35:00Z\"\n},\n{\n\"sessionName\": \"Mentor ? Mentee: Deep Dive Within ????\",\n\"speakers\": [\"Isabella Garcia\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T09:00:00Z\",\n\"endTime\": \"2025-08-11T09:45:00Z\"\n},\n{\n\"sessionName\": \"School of Doc: Getting Started with Documentation\",\n\"speakers\": [\"Liam Johnson\", \"Juan Rodriguez\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T09:55:00Z\",\n\"endTime\": \"2025-08-11T10:40:00Z\"\n},\n{\n\"sessionName\": \"System Governance using the 4 Cs\",\n\"speakers\": [\"Fatima Al-Rashid\", \"Arjun Ahmed\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T10:50:00Z\",\n\"endTime\": \"2025-08-11T11:35:00Z\"\n},\n{\n\"sessionName\": \"Flow First | Build client facing forms in Salesforce with Flow\",\n\"speakers\": [\"Kwasi Ogunjimi\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T11:45:00Z\",\n\"endTime\": \"2025-08-11T12:30:00Z\"\n},\n{\n\"sessionName\": \"A First Look at Data Cloud\",\n\"speakers\": [\"Sofia Fernandez\", \"Jake Llorrac\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T13:00:00Z\",\n\"endTime\": \"2025-08-11T13:45:00Z\"\n},\n{\n\"sessionName\": \"Drive Salesforce Adoption with Influence (even if youre not their manager)\",\n\"speakers\": [\"Camila Lopez\", \"Juan Rodriguez\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T13:55:00Z\",\n\"endTime\": \"2025-08-11T14:40:00Z\"\n},\n{\n\"sessionName\": \"Simplifying Pricing & Contract Management: A Native, CPQ-less Approach to RevOps\",\n\"speakers\": [\"Zainab Al-Zaabi\", \"Noah Brown\"],\n\"location\": \"Breakout Room B\",\n\"startTime\": \"2025-08-11T14:50:00Z\",\n\"endTime\": \"2025-08-11T15:35:00Z\"\n},\n{\n\"sessionName\": \"I said this...you heard that\",\n\"speakers\": [\"Layla Al-Rashid\"],\n\"location\": \"Breakout Room C\",\n\"startTime\": \"2025-08-11T09:00:00Z\",\n\"endTime\": \"2025-08-11T09:45:00Z\"\n},\n{\n\"sessionName\": \"Small Admin Team Meets Large User Base: 3 Strategies for Scaling Support!\",\n\"speakers\": [\"Kenji Tanaka\", \"Li Chen\"],\n\"location\": \"Breakout Room C\",\n\"startTime\": \"2025-08-11T09:55:00Z\",\n\"endTime\": \"2025-08-11T10:40:00Z\"\n},\n{\n\"sessionName\": \"5 Clues Your Datas Screaming for a Fix\",\n\"speakers\": [\"Maria Gomez\", \"Liam Jones\"],\n\"location\": \"Breakout Room C\",\n\"startTime\": \"2025-08-11T10:50:00Z\",\n\"endTime\": \"2025-08-11T11:35:00Z\"\n},\n{\n\"sessionName\": \"3 Easy Tips to Become a Data Storytelling Expert\",\n\"speakers\": [\"Liam Jones\"],\n\"location\": \"Breakout Room C\",\n\"startTime\": \"2025-08-11T11:45:00Z\",\n\"endTime\": \"2025-08-11T12:30:00Z\"\n},\n{\n\"sessionName\": \"Growing your Salesforce Org : How to Raise a Successful Salesforce Family\",\n\"speakers\": [\"Xiao Chen\", \"Kwasi Adeyemi\"],\n\"location\": \"Breakout Room C\",\n\"startTime\": \"2025-08-11T13:00:00Z\",\n\"endTime\": \"2025-08-11T13:45:00Z\"\n},\n{\n\"sessionName\": \"Power\",\n\"speakers\": [\"Test Speaker\"],\n\"location\": \"Test Room\",\n\"startTime\": \"2025-08-11T13:55:00Z\",\n\"endTime\": \"2025-08-11T14:40:00Z\"\n}]}"}, sessionId=e393e1ff-639f-4893-b549-41e4b7a71c19}, success=true]';

System.debug('Testing with longer sample response length: ' + sampleResponse.length());

// Test the parsing
Map<String, Object> parsedResult = AiAgentResponseParser.parseScheduleResponse(sampleResponse);
System.debug('Parsed result: ' + JSON.serialize(parsedResult));

System.debug('Test completed.'); 