
public with sharing class ScheduleAgentCreateController {
    @InvocableMethod(
        label='Insert Session Slot records to complete scheduling'
        description='This will create the session slot records that have been generated by the scheduler'
    )
    public static List < SessionSlotArray > getSessionsToSchedule(List < SessionSlotArray > input) {
        System.debug('Input: ' + JSON.serialize(input));

        List < Session_Slot__c > sessionSlots = new List < Session_Slot__c > ();
        for (SessionSlotArray sessionSlotArray: input) {
            for (SessionSlot sessionSlot: sessionSlotArray.sessionSlotArray) {
                Session_Slot__c ss = new Session_Slot__c();
                ss.Session__c = sessionSlot.sessionId;
                ss.Session_Location__c = sessionSlot.locationId;
                ss.Start_Time__c = sessionSlot.startTime;
                ss.End_Time__c = sessionSlot.endTime;
                ss.Date__c = sessionSlot.sessionDate;
                sessionSlots.add(ss);
            }
        }

        insert sessionSlots;

        return input;

    }

    public class SessionSlotArray {
        @InvocableVariable(
            description='Session Slot Array'
        )
        public List < SessionSlot > sessionSlotArray;

        public SessionSlotArray() {}

        public SessionSlotArray(List < SessionSlot > sessionSlotArray) {
            this.sessionSlotArray = sessionSlotArray;
        }
    }


    public class SessionSlot {
        public Id sessionSlotId;
        public Id sessionId;
        public Id locationId;
        public Time startTime;
        public Time endTime;
        public Date sessionDate;

        public SessionSlot() {}

        public SessionSlot(Id sessionId, Id locationId, Time startTime, Time endTime, Date dt) {
            this.sessionId = sessionId;
            this.locationId = locationId;
            this.startTime = startTime;
            this.endTime = endTime;
            this.sessionDate = dt;
        }
    }
}